<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>V8Js Patches merged | ~stesie's musings</title>
<meta name=keywords content="PHP,V8Js,V8,Sandboxing,PECL"><meta name=description content="Today the last pull request in a series of contributions to the V8Js PHP extension has been merged. Good time to loose some words on the project and why I like it, so here we go :-)
V8Js is a PHP extension that integrates Google&rsquo;s V8 JavaScript engine into PHP. This is the extension allows you to execute JavaScript code securely sandboxed from PHP. Besides it allows for simple exchange of data from PHP to JavaScript and back."><meta name=author content><link rel=canonical href=https://stefansiegl.de/2013/07/v8js-patches-merged/><link crossorigin=anonymous href=/assets/css/stylesheet.0c89971808195fcfba02b00128bb5209e165ff89d76c2f0d04eaefef9e1bd82a.css integrity="sha256-DImXGAgZX8+6ArABKLtSCeFl/4nXbC8NBOrv754b2Co=" rel="preload stylesheet" as=style><link rel=icon href=https://stefansiegl.de/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://stefansiegl.de/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://stefansiegl.de/favicon-32x32.png><link rel=apple-touch-icon href=https://stefansiegl.de/apple-touch-icon.png><link rel=mask-icon href=https://stefansiegl.de/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://stefansiegl.de/2013/07/v8js-patches-merged/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=me href=https://wue.social/@rolf><meta property="og:title" content="V8Js Patches merged"><meta property="og:description" content="Today the last pull request in a series of contributions to the V8Js PHP extension has been merged. Good time to loose some words on the project and why I like it, so here we go :-)
V8Js is a PHP extension that integrates Google&rsquo;s V8 JavaScript engine into PHP. This is the extension allows you to execute JavaScript code securely sandboxed from PHP. Besides it allows for simple exchange of data from PHP to JavaScript and back."><meta property="og:type" content="article"><meta property="og:url" content="https://stefansiegl.de/2013/07/v8js-patches-merged/"><meta property="article:section" content="pages"><meta property="article:published_time" content="2013-07-17T00:00:00+00:00"><meta property="article:modified_time" content="2025-01-03T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="V8Js Patches merged"><meta name=twitter:description content="Today the last pull request in a series of contributions to the V8Js PHP extension has been merged. Good time to loose some words on the project and why I like it, so here we go :-)
V8Js is a PHP extension that integrates Google&rsquo;s V8 JavaScript engine into PHP. This is the extension allows you to execute JavaScript code securely sandboxed from PHP. Besides it allows for simple exchange of data from PHP to JavaScript and back."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Pages","item":"https://stefansiegl.de/pages/"},{"@type":"ListItem","position":2,"name":"V8Js Patches merged","item":"https://stefansiegl.de/2013/07/v8js-patches-merged/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"V8Js Patches merged","name":"V8Js Patches merged","description":"Today the last pull request in a series of contributions to the V8Js PHP extension has been merged. Good time to loose some words on the project and why I like it, so here we go :-)\nV8Js is a PHP extension that integrates Google\u0026rsquo;s V8 JavaScript engine into PHP. This is the extension allows you to execute JavaScript code securely sandboxed from PHP. Besides it allows for simple exchange of data from PHP to JavaScript and back.","keywords":["PHP","V8Js","V8","Sandboxing","PECL"],"articleBody":"Today the last pull request in a series of contributions to the V8Js PHP extension has been merged. Good time to loose some words on the project and why I like it, so here we go :-)\nV8Js is a PHP extension that integrates Google’s V8 JavaScript engine into PHP. This is the extension allows you to execute JavaScript code securely sandboxed from PHP. Besides it allows for simple exchange of data from PHP to JavaScript and back.\nI like V8Js as it allows to run customer-provided code on the server, knowing that it is properly sandboxed so it cannot interact with all your PHP classes, variables and whatnot. Instead you can (and have to) provide a restricted set of classes acting as an API the JavaScript code can use.\nFirst things first, a simple hello world:\n$a = new V8Js(); $a-\u003eexecuteString('print(\"Hello World\\n\");'); … super simple and doesn’t do very much.\nOf course you can inject object instances as well:\nclass LoaderWriter { public function addRecord($type = 'text', $value = '') { echo \"addRecord -- $type, $value\\n\"; } } $jscode = \u003c\u003c\u003c EOT PHP.loader.addRecord(\"text\", \"first loader insert\"); EOT; $a = new V8Js(); $a-\u003eloader = new LoaderWriter(); $a-\u003eexecuteString($jscode); However that’s still stuff you’d expect to work. What about pushing closures from JavaScript to PHP and call these from PHP? Works!\nclass Parser { protected $_callbacks = array(); public function on($element, $callback) { $this-\u003e_callbacks[$element] = $callback; } public function runParser() { // should be fleshed out of course :-) $this-\u003e_callbacks['node']('node-1 content'); $this-\u003e_callbacks['node']('node-2 content'); } } $jscode = \u003c\u003c\u003c EOT PHP.parser.on(\"node\", function(data) { print(\"Found node, content \" + data + \"\\n\"); }); EOT; $a = new V8Js(); $a-\u003eparser = new Parser(); $a-\u003eexecuteString($jscode); $a-\u003eparser-\u003erunParser(); … this way you can easily use PHP’s nice XmlReader to read chunks from XML files and have a customer-provided piece of JavaScript code bind on certain elements to drive customer-fitted data imports.\nThe code just does what you expect, it initializes a parser class, binds an element handle (which is a JavaScript function) and afterwards the parser (written in PHP) just calls the callback function transparently. And of course it’s not just possible to provide scalar values back and forth, you can pass objects just as transparently.\nTurned out that V8Js leaked some memory for each object being passed back to JavaScript, which doesn’t hurt much if you do it for a limited number of times. If you run the callback from above for a huge XML file you’re quickly hit. The problem was, that V8Js incremented the refcount on the PHP object, but didn’t decrease if V8 decided to dispose the JavaScript instance. The fix for this is merged since July 11th.\nOfficially the PECL package is still in beta state and I found some bugs after a limited number of evaluation hours … if you can live with that I think V8Js is a pretty cool sandbox environment, definitely worth a look.\nSince I’ve made myself familiar with the source I also replaced deprecated calls to V8 API by newer equivalents and allowed for construction of PHP objects from JavaScript. This is do stuff like that:\n$v8 = new V8Js(); class Greeter { function sayHello($a) { echo \"Hello $a\\n\"; } } $jscode = \u003c\u003c\u003c EOT PHP.greeter.sayHello(\"John\"); // prints \"Hello John\" as expected print(PHP.greeter); print(\"\\n\"); // prints \"[object Greeter]\" as expected // What about the constructor function of greeter? print(PHP.greeter.constructor); // ... yields \"function Greeter() { [native code] }\" // ... super, so let me create more greeters :-) var ngGreeter = new PHP.greeter.constructor(); ngGreeter.sayHello(\"Ringo\"); // well, ... used to segfault :-) EOT; $v8-\u003egreeter = new Greeter(); $v8-\u003eexecuteString($jscode); … I can’t immediately come up with a use case, but hey, JavaScript is all about (constructor) functions, so it definitely should work. And of course it shouldn’t be possible to crash the sandbox :-)\n","wordCount":"635","inLanguage":"en","datePublished":"2013-07-17T00:00:00Z","dateModified":"2025-01-03T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://stefansiegl.de/2013/07/v8js-patches-merged/"},"publisher":{"@type":"Organization","name":"~stesie's musings","logo":{"@type":"ImageObject","url":"https://stefansiegl.de/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://stefansiegl.de/ accesskey=h title="~stesie's musings (Alt + H)">~stesie's musings</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://stefansiegl.de/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://stefansiegl.de/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://stefansiegl.de/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://stefansiegl.de/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">V8Js Patches merged</h1><div class=post-meta>Planted:&nbsp;<span title='2013-07-17 00:00:00 +0000 UTC'>Jul 17, 2013</span>&nbsp;·&nbsp;3 min</div></header><div class=post-content><p>Today the last pull request in a series of contributions to the <a href=https://github.com/preillyme/v8js>V8Js PHP extension</a> has been merged. Good time to loose some words on the project and why I like it, so here we go :-)</p><p>V8Js is a PHP extension that integrates Google&rsquo;s V8 JavaScript engine into PHP. This is the extension allows you to execute JavaScript code securely sandboxed from PHP. Besides it allows for simple exchange of data from PHP to JavaScript and back.</p><p>I like V8Js as it allows to run customer-provided code on the server, knowing that it is properly sandboxed so it cannot interact with all your PHP classes, variables and whatnot. Instead you can (and have to) provide a restricted set of classes acting as an API the JavaScript code can use.</p><p>First things first, a simple hello world:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$a <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>V8Js</span>();
</span></span><span style=display:flex><span>$a<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>executeString</span>(<span style=color:#e6db74>&#39;print(&#34;Hello World\n&#34;);&#39;</span>);
</span></span></code></pre></div><p>&mldr; super simple and doesn&rsquo;t do very much.</p><p>Of course you can inject object instances as well:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>LoaderWriter</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>addRecord</span>($type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;text&#39;</span>, $value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;addRecord -- </span><span style=color:#e6db74>$type</span><span style=color:#e6db74>, </span><span style=color:#e6db74>$value\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$jscode <span style=color:#f92672>=</span> <span style=color:#f92672>&lt;&lt;&lt;</span> <span style=color:#a6e22e>EOT</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PHP</span><span style=color:#f92672>.</span><span style=color:#a6e22e>loader</span><span style=color:#f92672>.</span><span style=color:#a6e22e>addRecord</span>(<span style=color:#e6db74>&#34;text&#34;</span>, <span style=color:#e6db74>&#34;first loader insert&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>EOT</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$a <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>V8Js</span>();
</span></span><span style=display:flex><span>$a<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>loader</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>LoaderWriter</span>();
</span></span><span style=display:flex><span>$a<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>executeString</span>($jscode);
</span></span></code></pre></div><p>However that&rsquo;s still stuff you&rsquo;d expect to work. What about pushing closures from JavaScript to PHP and call these from PHP? Works!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Parser</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>protected</span> $_callbacks <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>on</span>($element, $callback) {
</span></span><span style=display:flex><span>      $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>_callbacks</span>[$element] <span style=color:#f92672>=</span> $callback;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>runParser</span>() {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// should be fleshed out of course :-)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>_callbacks</span>[<span style=color:#e6db74>&#39;node&#39;</span>](<span style=color:#e6db74>&#39;node-1 content&#39;</span>);
</span></span><span style=display:flex><span>      $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>_callbacks</span>[<span style=color:#e6db74>&#39;node&#39;</span>](<span style=color:#e6db74>&#39;node-2 content&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$jscode <span style=color:#f92672>=</span> <span style=color:#f92672>&lt;&lt;&lt;</span> <span style=color:#a6e22e>EOT</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PHP</span><span style=color:#f92672>.</span><span style=color:#a6e22e>parser</span><span style=color:#f92672>.</span><span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#34;node&#34;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>data</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;Found node, content &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span><span style=color:#a6e22e>EOT</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$a <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>V8Js</span>();
</span></span><span style=display:flex><span>$a<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>parser</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Parser</span>();
</span></span><span style=display:flex><span>$a<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>executeString</span>($jscode);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$a<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>parser</span><span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>runParser</span>();
</span></span></code></pre></div><p>&mldr; this way you can easily use PHP&rsquo;s nice XmlReader to read chunks from XML files and have a customer-provided piece of JavaScript code bind on certain elements to drive customer-fitted data imports.</p><p>The code just does what you expect, it initializes a parser class, binds an element handle (which is a JavaScript function) and afterwards the parser (written in PHP) just calls the callback function transparently. And of course it&rsquo;s not just possible to provide scalar values back and forth, you can pass objects just as transparently.</p><p>Turned out that V8Js leaked some memory for each object being passed back to JavaScript, which doesn&rsquo;t hurt much if you do it for a limited number of times. If you run the callback from above for a huge XML file you&rsquo;re quickly hit. The problem was, that V8Js incremented the refcount on the PHP object, but didn&rsquo;t decrease if V8 decided to dispose the JavaScript instance. The fix for this is merged since July 11th.</p><p>Officially the PECL package is still in beta state and I found some bugs after a limited number of evaluation hours &mldr; if you can live with that I think V8Js is a pretty cool sandbox environment, definitely worth a look.</p><p>Since I&rsquo;ve made myself familiar with the source I also replaced deprecated calls to V8 API by newer equivalents and allowed for construction of PHP objects from JavaScript. This is do stuff like that:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$v8 <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>V8Js</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Greeter</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>sayHello</span>($a) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Hello </span><span style=color:#e6db74>$a\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>  }   
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$jscode <span style=color:#f92672>=</span> <span style=color:#f92672>&lt;&lt;&lt;</span> <span style=color:#a6e22e>EOT</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PHP</span><span style=color:#f92672>.</span><span style=color:#a6e22e>greeter</span><span style=color:#f92672>.</span><span style=color:#a6e22e>sayHello</span>(<span style=color:#e6db74>&#34;John&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>// prints &#34;Hello John&#34; as expected
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>print</span>(<span style=color:#a6e22e>PHP</span><span style=color:#f92672>.</span><span style=color:#a6e22e>greeter</span>); <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>// prints &#34;[object Greeter]&#34; as expected
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// What about the constructor function of greeter?
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>print</span>(<span style=color:#a6e22e>PHP</span><span style=color:#f92672>.</span><span style=color:#a6e22e>greeter</span><span style=color:#f92672>.</span><span style=color:#a6e22e>constructor</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ... yields &#34;function Greeter() { [native code] }&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ... super, so let me create more greeters  :-)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ngGreeter</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PHP</span><span style=color:#f92672>.</span><span style=color:#a6e22e>greeter</span><span style=color:#f92672>.</span><span style=color:#a6e22e>constructor</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ngGreeter</span><span style=color:#f92672>.</span><span style=color:#a6e22e>sayHello</span>(<span style=color:#e6db74>&#34;Ringo&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>// well, ... used to segfault :-)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>EOT</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$v8<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>greeter</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Greeter</span>();
</span></span><span style=display:flex><span>$v8<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>executeString</span>($jscode);
</span></span></code></pre></div><p>&mldr; I can&rsquo;t immediately come up with a use case, but hey, JavaScript is all about (constructor) functions, so it definitely should work. And of course it shouldn&rsquo;t be possible to crash the sandbox :-)</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://stefansiegl.de/tags/php/>PHP</a></li><li><a href=https://stefansiegl.de/tags/v8js/>V8Js</a></li><li><a href=https://stefansiegl.de/tags/v8/>V8</a></li><li><a href=https://stefansiegl.de/tags/sandboxing/>Sandboxing</a></li><li><a href=https://stefansiegl.de/tags/pecl/>PECL</a></li></ul></footer></article></main><footer class=footer><span>© 2025 Stefan Siegl · all content is <a href=https://creativecommons.org/licenses/by-sa/4.0/deed>CC-BY-SA</a> · <a href=https://www.swyx.io/digital-garden-tos#for-visitors>Terms of Service</a></span> ·
<a href=/imprint>Imprint</a> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>